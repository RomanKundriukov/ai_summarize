<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="ai_summarize.View.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:ai_summarize.View"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ui="using:CommunityToolkit.WinUI"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:media="using:CommunityToolkit.WinUI.Media"
    xmlns:ollama="using:ai_summarize.Model"
    xmlns:_vm="using:ai_summarize.ViewModel"
    mc:Ignorable="d">

    <Page.Resources>

        <media:AttachedCardShadow x:Key="CommonShadow"
                                  Offset="4" />

        <Style BasedOn="{StaticResource DefaultButtonStyle}"
               TargetType="Button">
            <Setter Property="ui:Effects.Shadow" Value="{StaticResource CommonShadow}" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>

        <!--<ui:AttachedDropShadow x:Key="CommonShadow"
                               CastTo="{x:Bind ShadowTarget}"
                               Offset="4" BlurRadius="16"
                               Opacity="0.35"/>-->

        <!--<Style x:Key="ShadowedElementStyle" TargetType="FrameworkElement">
            <Setter Property="ui:Effects.Shadow" Value="{StaticResource CommonShadow}"/>
        </Style>

        <Style TargetType="Button" BasedOn="{StaticResource AccentButtonStyle}">
            <Setter Property="ui:Effects.Shadow" Value="{StaticResource CommonShadow}"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>-->

        <!--<Style TargetType="Border">
            <Setter Property="ui:Effects.Shadow" Value="{StaticResource CommonShadow}"/>
            <Setter Property="CornerRadius" Value="7"/>
            
        </Style>-->
    </Page.Resources>

    <Grid RowSpacing="15">

        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0" ui:Effects.Shadow="{StaticResource CommonShadow}"
>
            <FlipView 
                 Background="DarkGray"
                 Height="60" 
                 BorderThickness="1" 
                 ItemsSource="{x:Bind _vm.models, Mode=OneWay}">

                <FlipView.ItemTemplate>
                    <DataTemplate x:DataType="ollama:OllamaModels">
                        <Grid>
                            <TextBlock Foreground="{ThemeResource TextFillColorPrimaryBrush}" 
                                       Text="{x:Bind ModelName}" 
                                       Padding="12,12" 
                                       Style="{StaticResource TitleTextBlockStyle}" 
                                       HorizontalAlignment="Center"
                                       TextWrapping="Wrap"/>
                        </Grid>
                    </DataTemplate>
                </FlipView.ItemTemplate>
            </FlipView>
        </Border>

        <Border Grid.Row="1" ui:Effects.Shadow="{StaticResource CommonShadow}" BorderThickness="1" >

            <ScrollView AllowDrop="True" 
                        Background="DarkGray"
                        DragOver="{x:Bind _vm.Grid_DragOver}"
                        Drop="{x:Bind _vm.Grid_Drop}"
                        Height="auto" 
                        ZoomMode="Disabled" 
                        HorizontalScrollMode="Disabled" 
                        VerticalScrollMode="Auto">

                <Grid>
                    <TextBlock Text="{x:Bind _vm.SummarizeText, Mode=OneWay}"
                               Padding="12,12"
                               Foreground="{ThemeResource TextFillColorPrimaryBrush}"
                               Style="{StaticResource TitleTextBlockStyle}" 
                               TextWrapping="Wrap"
                               FontSize="18" FontWeight="SemiBold"
                               VerticalAlignment="Center" HorizontalAlignment="Center"/>

                    <Grid Background="#80000000" Visibility="{x:Bind _vm.IsSummarized, Mode=OneWay}">
                        <ProgressRing IsActive="True"
                                      Width="80" Height="80"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                    </Grid>

                </Grid>
                
            </ScrollView>

        </Border>
    </Grid>

</Page>
